<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
</head>

  <script src="https://npmcdn.com/es6-promise@3.2.1"></script>
  <script type="text/javascript" src="jquery.min.js"></script>
  <script type="text/javascript" src="powerbi.min.js"></script>
  <script type="text/javascript">

        //This code is for sample purposes only.

        //Configure IFrame for the Report after you have an Access Token. See Default.aspx.cs to learn how to get an Access Token
        window.onload = function () {
            var accessToken = 'H4sIAAAAAAAEACWWta7FCpZE_-Wlbsl4DC11YGZmZ2Zm9mj-fe6o8x3V2lpV__OPlb7DnBb__Pufc7i_07jZ48YHsOwIo0RhYx2dRk_MV_zNLRBIqfkWImxLc_lLCwlYJp-xmIfWfyMVJs4DDNtoOgnTjIpQRFvo_jxjsCm4WuRvXAQK6_bF0kHPSOaJGkl-qGuXIUKjij0v713Dy046LOeadzAOCp-WxbSHVpPnwi4RW3TgHFKHw9aBdYmsyoQfWqS1eTtN6ottXIvWs8HvOAcn50RBA8nKY6RPkr3G6aGOBOC2cPbxWinaKgXYecXqnvnTciiCHkwr9_NASOcoLtB7xtV20OMSwGDesnxkXdguaJQrz7OVh91MCUvFnvPKhw2dbscVRxPLxIuWM53aen2UEKIu1TMkYliLF_uOZ5JD9eqMXMysVz6wuCqGTZ1_Wj74V5zgcamGKpqRVI6Lsa1ksYJPpabGCEvq7lJLKFlgWBFjiuTObxtBUfw-NJfgUf2pEMR7-QaFSWKYgP3WefRgPbCYLJ_n5ccdLZ4juR5awLu4zK1liNmJvoke1ElgihEGF4v9onAozCm8iqCCHC3tUN_T4GH3LDvLmD4FbI8MRjFo20GUApee64GI0rVdDsPnaDOrf_e54mGOTWbh1eLexc2VHwYjlE4pgk8WEoKezHsNv22HmhbUBa64xLeUcv69dUXe_kwTRimJzlScqcQ5EIQ1C1tvhutw8QBjb0xeDiYuKw3CkDEQkqACuIuxTspPHI7EmxuC4r-dWoSqul5F8dPNEPyeiBsoUTDZwdXXDnx3cDNjJyctw1K_dNCYN5PAeUJOFfN5c3nNqUZ2NMroqcrmoo_ftnQ9pvktuBOEra38OSI8CQBwVSGEzhmHMfA1-ivL-Y8o9zH9B9TFCcWM7qFmPvPzb09cZQJKtje2Y3cC4YIedkJooplMeykT4rL9u0ZL39Vd6GcoCfHx4SEXFnXVNGQ7uYtvOeUlJw1E1VKyAVmt9Ac5OChx_rKAsRCDimux5_YsGiG3FSyHZjb1Yf2shr8jtOfsFw6Mi37xGdERD3ow1St2X4MgsjZmxKW4bHnwklh_6U-rI87Xdd8iWiqnpktHN8FhJrgcJ0Qt61sw3wiIpHkf7eqiGTUqFYrUJq62A0iEHwggfrYWoaROIzdVQWgtcaofOp_yJKfC-pUn4bN9VntcydNQpBTYkuI8BAFePVmO-Ue3Br_pnF5N5N4xziTsvJfuBDwQMRiAd6qM3uMZ0j7QGAhRe90NjqKCJBLBwGVrioso5SrVSEbZtQ--_M3z_jM21abzmIRdBhY6YOlcWZ6lX6h9VMN7-94gF1mmuNwAU2AfmHOp0HgXzytCt1crbCq_BA5Xan2K13w9fWaB9WEa9GL4TaNEpSROl31QZMRj5K5KrKIfIf9-s2OWD10mF1_yqaDfPudumTN_w9F43G2AxSvDYHLUvz__RCGrIQjSgw9s3zlPKZlW1cO6vEGSJ4mMMtfiO1aueE2-wBe0UhN6YZRkBEzIbgTKACzUfCswEyifqWXG-2rnlQyTdA2vhhGadL5cN9mhDMmPcj5-DPnkGVkXJEGRHH4hukHqxq419V0sIjBq3M21Cvr0HfP7CmY445QpqaBq4Y4qehK8AZe-pqirwQH8mOT5zwco41BtsSy7tzRwv998oJI3spUn3_MDGLa0e-0m8CSMj4_F-jCsnPrz42HkCO3vUM80HKJWFXky-kD3xrCkU8zyCwSOGDHpF94n_NxNaFo9Xr63Rdvd1GdmXGQ3Z2_EuE7p3WqoyqmnpuauHKgYKptfqtA0GOwDplDm1JyiArJVJFJoBLnqHah5wa9BrHpvZYwHaAT2iPCojd0rz5JuCm830RRrFnqGSV8a1EuB97xPah46QUBs_YEzsQf0n7FZiekYMzqMEZqiIsKYSjLF2l2S38VTGd6_oiilE7vxYUEL6clIc33gjpyN8vw73KF5Ypjz0hhuXCzQaxklkJcQlU17TgyfJaUWlkshEFrUNyG83aAfKwtrNKLhXJGUOifgd0kbofDEn4IFbUxSFVtkBYiImSsqwcEkUy2TwfuBieUhIT71DVHKW9dM_qrGqDoXo1LcwlOQF6Lhr9bHeA2E74yoeh9BlIs8khp4oeUDKHLJ2XJckcgVRpVey0EvRjuiqbFqi6EIYTgtmey4XxIkMKyhMnOV7NzeghFxHXvnpbxjkbmGCfznVRO3OV9axZlEv9phk0SYHsbIOWcPBkpQCPlT4rg-iI7PYCn0jWtN1JmiUZCDJCFcEzzcWzXvD8Thy6droy7LidQhhCPoNqHaOFgHR1LVNigGBPoTUP51WfOQ6kTJlcq7uiGR33Na_fjs9BI13to-oD4GgOI4dB8QMAkH2EDuKgG3nP7K3WVrgOYNysSgSuJWjhGpq27LahyE_hoa-N7bV_HLfmfyXtDjSQ9feRc0L07LD8P6P__551__sNu7HLNavn8zy8NMT2K5-3qYd4K_bLGjFlBBeGoRRoxWW7Tz03Ldk-aLKAiNEPdbJUZ64AIY9YF_0-_L4lbWHeb6-vTRJKb-vphBrSKm4yE2c5zxJ2v6IRXYkX30ZD33Aaw3ZddrC_68ENC6X0p0NwhEesSZH9DdM9txrlRhZEaYh_UWlOcNUSbNUBLvs44sTuaX0YMT339ibf62EeZsLwvYlvjknztbGbuHQWSEj1UC3pAGmq6SV8TSO9eH6Zx7n7hgrmuTgNG4YBE8W9WWEXmVnMC7Nzmy69Ltfs0P9giIEPZMSjXYAOBqbT9-4UX19iyFsRt2SB3TGlhakF6l3FFrxld7Q7AGZzXf_435XZpyk4O_lLPkkLh4sPxRYGCZkNyQDef_wnDbekqPcyv_zgqr-8H1yTa6ipNxiwuTCcKy-z1JwLhjNpRnpz5fkgQsvkPtT41bbpBIYp8Sb1oXzerD3m6mBZEm82gpnDBNFtF7sISz5_hQP2qEArJM7eVN7EKFU2Id1Nv2ccWQmTsIv-R3c-ktTWtXTm4ym0Mt3mpskVNJirbveloEo97_hFcLTHbP-KQHDJAnMGf5OPwcSqoKzhzxZCItbVuZ6qkPmNqxoezysD215dOr4ozo5kX77cIGIPL3umFde_KxQkmQca_eXoOldLrF4u3vKVwQlAuRMjET_Z2kc9aBoAANqXN3DVXKF08xnNTka6AHFMipMEsVzrq2i-jtQu5WIMX9osbS_8P43_8Dum7nAloMAAA=';
            var embedUrl = 'https://app.powerbi.cn/reportEmbed?reportId=4ea7fd88-240c-4d43-ae51-cbac319cee31&groupId=dbc42c25-9eef-4516-a6f7-7ec1d02e2eed';
            var reportId = '4ea7fd88-240c-4d43-ae51-cbac319cee31';

            // Read embed type from radio
            var tokenType = $('input:radio[name=tokenType]:checked').val();
            // Get models. models contains enums that can be used.
            var models = window['powerbi-client'].models;

            // Embed configuration used to describe the what and how to embed.
            // This object is used when calling powerbi.embed.
            // This also includes settings and options such as filters.
            // You can find more information at https://github.com/Microsoft/PowerBI-JavaScript/wiki/Embed-Configuration-Details.
            var config = {
                type: 'report',
                tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
                accessToken: accessToken,
                embedUrl: embedUrl,
                id: reportId,
                permissions: models.Permissions.All /*gives maximum permissions*/,
                viewMode: models.ViewMode.ReadOnly,
                settings: {
                    panes: {
                        filters: {
                            visible: false
                        },
                        pageNavigation: {
                            visible: false
                        }
                    }
                }
            };

            //// Grab the reference to the div HTML element that will host the report.
            //var reportContainer = document.getElementById('reportContainer');

            //// Embed the report and display it within the div container.
            //var report = powerbi.embed(reportContainer, config);


            // Get a reference to the embedded report HTML element
            var embedContainer = $('#reportContainer')[0];

            // Embed the report and display it within the div container.
            var report = powerbi.embed(embedContainer, config);

            // Report.off removes a given event handler if it exists.
            report.off("loaded");

            // Report.on will add an event handler which prints to Log window.
            report.on("loaded", function () {
                console.log("Loaded");
            });

            // Report.off removes a given event handler if it exists.
            report.off("rendered");

            // Report.on will add an event handler which prints to Log window.
            report.on("rendered", function () {
                console.log("Rendered");
            });

            report.off("error");
            report.on("error", function (event) {
                Log.log(event.detail);
            });

            report.off("saved");
            report.on("saved", function (event) {
                Log.log(event.detail);
                if (event.detail.saveAs) {
                    console.log('In order to interact with the new report, create a new token and load the new report');
                }
            });
        }
    </script>

    <header>
        <h1>
            Power BI Embedded Report Demo
        </h1>
    </header>

    <div>
        Embedded Report
        <br />
        <div ID="reportContainer" style="width: 900px; height: 500px"></div>
    </div>



</html>
