<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
</head>

  <script src="https://npmcdn.com/es6-promise@3.2.1"></script>
  <script type="text/javascript" src="jquery.min.js"></script>
  <script type="text/javascript" src="powerbi.min.js"></script>
  <script type="text/javascript">

        //This code is for sample purposes only.

        //Configure IFrame for the Report after you have an Access Token. See Default.aspx.cs to learn how to get an Access Token
        window.onload = function () {
            var accessToken = 'H4sIAAAAAAAEACWWR6rFCpJE9_KnapB3DTWQ915XbibvvVfRe-9H1TwgyMgk8vz7Hzt9hzkt_vnff6yT92ER9G2Cl6gVff2JhMxaupGDlozEV5vsyqmgz1Is4yQOObAZ64bfVBzzaGk8aMeUedReghGa8_4iWeoIGRDNL9bgLABWvMqC-JZrOfCeIgxVRgSazjwfi7vkafFSbprt4fENiEfYnUq02ArYICJHlg0ALYyYNZaW2CXNaf1A6jx2J1MD_zLNMrdtIaDveirPi3-Tcy8WFpbOtEujaGraWxSseKHmuO6wBwMU5tvs8XRbKY6KA9xdxEUtgGrRt-6nYpHaYD6R0uH8RSYWBRVVOCnvcGwxjfRIYbJ9gVtSUkjIrVo-lY4JeGkMifNkyPpWRWSZaex4P9rHfQf2EyzHVW9D7K0F0CckHZVs1HogXQ7ZrZz031m6_RqgdlNifN8dEcAi7fky8FyBkFBknONK4z2sTHfS6flQBSf7If8OTlm8uL6SZOMIMrCUvjJus2bvBh8GFtXm3QJ7vGhPAimRcLGLkuM1KIFeit05SVvIA39WnPDjWzGhZyidKP1c1bfxOaEYmacckUjGCx0JvTtJi12P1Q9IJw0kKfuXLc4Jvb_wiX7ow-PardyRtNApAe4a7lpIxkQUsH_jNXh8UiEZFY1D-pQFwFCix13Lm88B6QXiS0uQwKI4tjPWMXq7vikbanxVxM2cP9wTMTdu1LibcJWlRq6rQ7o_Gqv3oBC64al5VF2rQAtskBNdCw_QfewR6xi-X8LBDWnHfEy6lGD7t1r0tMC3QO87uYTadw_qv_vLkaZvkdWDzlNRdnIvpI6yGqZyN-JZhFKQ2ttCnOyY6pH3U1jWHDgmdENQSjJP0Ck667tC48SpDQSPs0o2N8Nf3OgEzKdz3_O5Oo84c8wv7SiGJCDwcsCPg9Vbedrx0PfB7Jn3D35nbIzalpZ1JFL0Kq8S1-gB6MKJFBRwcxH_0zVYmD13rCXpzQ_VzcQiPR_lNF5vxRWkmm4VZeYnDs7TMeo4hGAiCCtMJAwfxGWYxmtE8zyZTGyvmGbzl-FRbqaQowSr3UUGQkBvQz3yG8BPA00lEPmE31YPSSsa0VcJP1VrOsJjxbMPZIYGWsNrGrRWQsj5afwg2tPC4pBx6atxRH6Au-_pgk20VXNwdUCUJDhflWR0hOFmHr5ipl5PobWVUYO59ayr8kzTIqB4urp7CpPpnVPKDLO-9y87IP7zjmHR-bb2RL9k0TvgiH4dnKef3jMkLCSzeWvah8F6WqaysvKU08XvcCM8JX1gwwlmXnNjcACHROXlM9M5IShNpCwAO_lRaiEggJKX0d3JiOoX-51mlXAB7PiwzHLA4x8k57PoyWyuxYYIOxpbdQMZoQ23TvpLnGp-NegExOBSrOgv3Kjc8siRHW4FQHf9HYngxmgkbNbcwqsjgpjj-Y3-Jd_aiN-qhHoxVjbOjF292Fuq_H4MM1z9hUuzHF7X6ARgF7OAhCXW5IhM0paS7dIt3eCeuPO5w5f1ozitMXKnRcaAGVNbihRp_02FcO_p5Glk-FdXxKx8rR-LlMT6rFP37qKfi3qP6E3awOqVL1cET0t25q-kN7tWGqhxpCQyFtsmz5co2pW5nFb4NaCeoKTuD2OG0Bx_AjU7bEVcleL2DPzCDWZPm3xcmrTOYTKF2x9yOApxfCsT3-IM4_riYf5nT9V0L6WsvEV-9_VKdG80t6p7nLqyoyblb3toO5PXdq3bsYVFJ7ytCdkAQ3nKIz_KQL4Z9mQMUoWbqU1bC_wyjyI8RKUUq_0q9DDGxsdxJH-tHiXnz7hTDMyFfgUnRLGb16kqOIFrh0q-UY5jD7nQVPDHiLHlDywfPKtNQSsV9ENTD3rS6Te2m2P22m7DiBDRDXGECv5kQkl20WnRCgQ4GErUiR0Y-MIQJisem69mj1I3beHh-dtnW3kdSCT6mAaYqSfp5br8een70Y1Y2E-fF1IkKqKYY5JTqgPRoCS7Cjsf8L3wBbnIRNxgoHNSHx_8BWLm1j1Eql1vm-Euvb6QWd6WgtndTflT7XwunkvwGaKQHuGbxNV19MoYueLrVL6kvi8Y2DRrXBUvoKWbem3gEQYjnVHb1I5OQwEdZkmtrmYr4RQiI8f3OuqO60cQObQ6RBRTjBku2kG9hMHg8NfBFmiRnfjMWRkCsSeh0I7LAL0igZUPeSAiF3_lcCpvgC6nXZYSGsa0Tkhg7cifw9LCpjqCt2NbYgr6od6vWEuqMMKhT_0muXbroB-7PbZ4Pt42gG4MzGpo95lpmoamVcfBhWRMasfRG2tG6hLWkUw5nJuFHig4OLxbGEuIVSGEHdIyOMnM8AE1pT7v998dRDEVOR4XozAQ6s4Rl8Cl_LWdUX4dbOsiJFckEb9WZyT6JEjEhqkg2pzQ9bOB9KB9wIuY4280zC5r9A9MTPwmAPDsYDY3le3-17_--Z9_uO1djlkr3z_MEnEPlSuHOoyTupxKYcETV9XHiUoyWsFr0YfT8M79jEPImAchsTKQxxG97rbmBB3RT5H8xgKsogWRkQTDoZivIoqg8I_WIZ68EMFEyRD-6BpilgPXpeYk6tSgm8KuFlbWYdu0D4icm-yA9teMS_4Q7MjzQ4c27MVLBoKZ8DtxER3KNnH39bFosofNGPYPccMXJBCY6eceLGLT2LTayXx47LVQHxMP18HUtOS0i-G4K3aY7qJawx5VSLWtKlp_G4qPhDWePKHbQYInEzkqjtk4BuzHetD9kUor_94-re2fLg4VLvwGa7p9GP9ZDdWIsIwrgonv1ruMQ_j7w5Np0ai8Yrm-_m_M79KUmxL8pXyW6kmihr5xTfaBruOlq5Q7_1F5bT2lx7mVf7KxX03Q1HqIE9UPVC4n-M1nc3c0HVbfbOp3SFKKI9uAYkE65nTLT3EHESeE3mlzMeDfBp_ZkZkgr3jWbapEG8HrLOV5iEBBEaVQATwTvOZf38_GX2QERooI7b7bogt7oiiL0syYkIZcTkdv2930d0vQ9YATWDZiI0NjzS5l90cb0cO5tF5QXgTQO9GqnnFG4Sq39hWFrUupkiChDRoN8N8L0S-aFgkC7O12ts-L1V_k_cIvF3f_SgiCTQouDPRIaX4i3IsiK3h_2zPKlX5_17Chf2gLjOe1ruA6z-TZDMFJ7rICY5cakfKvRXpGDSBvyd_3r8WnTZyZhQdM1AdtYcGcOWL-Yv6__wdjAiErWgwAAA==';
            var embedUrl = 'https://app.powerbi.cn/reportEmbed?reportId=4ea7fd88-240c-4d43-ae51-cbac319cee31&groupId=dbc42c25-9eef-4516-a6f7-7ec1d02e2eed';
            var reportId = '4ea7fd88-240c-4d43-ae51-cbac319cee31';

            // Read embed type from radio
            var tokenType = $('input:radio[name=tokenType]:checked').val();
            // Get models. models contains enums that can be used.
            var models = window['powerbi-client'].models;

            // Embed configuration used to describe the what and how to embed.
            // This object is used when calling powerbi.embed.
            // This also includes settings and options such as filters.
            // You can find more information at https://github.com/Microsoft/PowerBI-JavaScript/wiki/Embed-Configuration-Details.
            var config = {
                type: 'report',
                tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
                accessToken: accessToken,
                embedUrl: embedUrl,
                id: reportId,
                permissions: models.Permissions.All /*gives maximum permissions*/,
                viewMode: models.ViewMode.ReadOnly,
                settings: {
                    panes: {
                        filters: {
                            visible: false
                        },
                        pageNavigation: {
                            visible: false
                        }
                    }
                }
            };

            //// Grab the reference to the div HTML element that will host the report.
            //var reportContainer = document.getElementById('reportContainer');

            //// Embed the report and display it within the div container.
            //var report = powerbi.embed(reportContainer, config);


            // Get a reference to the embedded report HTML element
            var embedContainer = $('#reportContainer')[0];

            // Embed the report and display it within the div container.
            var report = powerbi.embed(embedContainer, config);

            // Report.off removes a given event handler if it exists.
            report.off("loaded");

            // Report.on will add an event handler which prints to Log window.
            report.on("loaded", function () {
                console.log("Loaded");
            });

            // Report.off removes a given event handler if it exists.
            report.off("rendered");

            // Report.on will add an event handler which prints to Log window.
            report.on("rendered", function () {
                console.log("Rendered");
            });

            report.off("error");
            report.on("error", function (event) {
                Log.log(event.detail);
            });

            report.off("saved");
            report.on("saved", function (event) {
                Log.log(event.detail);
                if (event.detail.saveAs) {
                    console.log('In order to interact with the new report, create a new token and load the new report');
                }
            });
        }
    </script>

    <header>
        <h1>
            Power BI Embedded Report Demo
        </h1>
    </header>

    <div>
        Embedded Report
        <br />
        <div ID="reportContainer" style="width: 900px; height: 500px"></div>
    </div>



</html>
